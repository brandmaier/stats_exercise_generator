---
title: "Kontrastanalyse"
author: "Andreas M. Brandmaier"
date: "11/19/2021"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
knitr::opts_chunk$set(echo = FALSE)

source("R/helper.R")
source("R/anova-1f.R")

include_solution <- !TRUE

empty_str <- "\\ "
```


# Aufgabe 1

In einer Studie wurde untersucht, inwiefern die unterschiedliche Bereitstellungsformen von Social Media Inhalten die Beliebtheit von Probandinnen beeinflußt. Konkret wurden Probandinnen randomisiert in verschiedene Gruppen aufgeteilt, die Inhalte nur über eine der vier Formen verbreiten sollten (Eigene Texte, Übernahme fremder Texte, eigene Fotos, eigene Videos). Eine einfaktorielle Varianzanalyse zeigte signifikante Unterschiede zwischen den vier Bedingungen. Folgende zwei spezifischen Hypothesen standen bereits vor der Datenerhebung fest und sollen mittels einer Kontrastanalyse untersucht werden:

1. Gibt es Unterschiede in der Beliebheit wenn statt Textinhalten Fotos oder Videos geteilt werden?
2. Ist die Beliebtheit größer in der Gruppe, die Videos teilt, als in der Gruppe, die Bilder teilt?

Führen Sie die Kontrastanalyse durch. Entscheiden Sie anhand der Fragestellung, ob es sich um einen gerichteten oder ungerichteten Test handeln muss. Sind die beiden Kontraste orthogonal?

```{r}
set.seed(23509)
aov1 <- generate_anova(factor_level_names = c("Eigene Texte","Fremde Texte", "Fotos","Videos"), within = 3, between=3, obs_round = 1)
```

```{r results="asis"}
ctr1 <- c(-1,-1,1,1)
ctr2 <- c(0,0,-1,1)
cat(contrast(aov1, ctr1))
cat("\n")
cat(contrast_hypotheses(x,0))
cat("\n")
cat(contrast(aov1, ctr2))
cat("\n")
cat(contrast_hypotheses(x,1))
cat("\n\n\n")
cat(orthogonal(ctr1, ctr2))
```

# Aufgabe 2

Wir betrachten nochmal die Aufgabe des Arbeitsblattes "Einfaktorielle Varianzanalyse", in der working alliance (also das Vertrauen und die Bereitschaft zur Zusammenarbeit) von Patienten in einer psychiatrischen Klinik untersucht wurde.
```{r}
set.seed(34059)
aov1 <- generate_anova(factor_level_names = c("Abhängigkeitssyndrom","Angststörung","Depressive Episode","Persönlichkeitsstörung"),num.facs = 4, num.obs.per.fac = 7,obs_round = 0, 
                       between=4,within=2, overallmean = 10,
                       obs_min=1,
                       obs_max=20,
                       alpha=0.01
                       )
```

Dabei waren folgende Faktorstufenmittelwerte gefunden worden:
```{r}
knitr::kable( data.frame(aov1$factor_level_names, aov1$factor_means) )
```

Im Vorfeld gab es die Vermutung, dass die working alliance von Personen mit einer emotional instabilen Persönlichkeitsstörung oder einer Abhängigkeitsstörung niederiger ist als bei den anderen untersuchten Störungen. Formulieren Sie das passende Hypothesenpaar und testen Sie dies in einem Kontrast. Formulieren Sie zusätzlich noch einen Kontrast, der orthogonal zu dem ersten ist.
 
```{r results="asis"}
ctr1 <- c(1,-1,-1,1)
cntr <- generate_contrast(aov1,ctr)
cat(contrast(aov1, ctr1))
cat("\n")
cat(contrast_hypotheses(aov1,0))
cat("\n")
cat(contrast_F(aov1))
```